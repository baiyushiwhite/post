title: javascript 垃圾回收
date: 2015-08-29 13:45:47
categories: [前端, js]
tags: [前端, js]
---
Javascript高级程序设计笔记
## 垃圾回收

 - Javascript有自动的垃圾回收机制，找出不再使用的变量释放其内存。垃圾收集器会按照固定的时间间隔周期性执行。
 - 垃圾收集器必须跟踪哪个变量有用哪个没用，对不再有用的变量打上标记已备将来回收其内存。标记无用变量的策略主要有两种：
  - 标记清除（mark-and-sweep）
   -当变量进入环境就将这个变量标记为“进入环境”，当变量离开环境，则标记为离开环境。
   -垃圾收集器在运行时会给内存中所有变量都加上标记，然后去掉环境中的变量以及被他们引用的变量。
   -最后垃圾收集器完成内存清除工作，回收内存空间
   -**当前主流垃圾回收算法**
  - 引用计数
    -跟踪记录每个值被引用的次数，当一个对象的引用次数为0，则回收其内存。
   -当前的js引擎都不用这种算法，但IE9之前的浏览器（IE9+把BOM和DOM对象转换成了真正的js对象）中访问非原生的js对象（如DOM对象BOM对象）时，用的是引用计数策略，这有可能导致循环引用的问题
    -会出现循环引用的问题：对象A持有对象B的引用，对象B持有对象A的引用。两个对象永远不会被销毁。当采用标记清除策略时，函数执行结束对象就销毁了不存在这个问题，而引用计数方式则永远不会销毁。出现内存泄露
    -因此要在不使用时手动断开他们之间的连接。

## 性能
虽然开发者不用关心内存管理的问题，但是系统给浏览器分配的内存资源有限，最好尽量减少内存的使用，一旦数据不用，最好通过设置其值为null来释放其引用（解除引用）。解除引用真正的作用是让值脱离执行环境，以便垃圾收集器下次运行时将它回收。